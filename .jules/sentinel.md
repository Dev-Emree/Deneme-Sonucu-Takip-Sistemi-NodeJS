## 2024-05-18 - [Denial of Service via Unvalidated Input in Express Routes]
**Vulnerability:** Express route handlers (`/new-tyt`, `/new-ayt`, `/new-ydt`, `/exam-public`) were accessing `.length` on `req.body.examName` without verifying that `req.body.examName` was present or a string. Similarly, they accessed `req.session.passport.user` without ensuring `req.session.passport` was populated. This meant an attacker sending an empty or malformed JSON payload could throw unhandled TypeErrors, crashing the node process.
**Learning:** In standard Express setups, missing body properties or session data result in `undefined`, not empty strings/objects. Because Node crashes on unhandled exceptions in asynchronous routes unless handled by an error-catching middleware, all input paths accessing nested object properties must have rigorous type and existence checks.
**Prevention:** Always validate `typeof req.body.property === 'string'` before calling string methods or checking length. Ensure `req.session` and `req.session.passport` exist before accessing user IDs. Use defensive checks (e.g. `!req.session || !req.session.passport || req.session.passport.user === undefined`).
